<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <meta content="email=no" name="format-detection">
    <title>订单</title>
    <link rel="stylesheet" type="text/css" href="/css/style.css"/>
    <script src="/js/jquery-1.9.1.js"></script>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<script src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<script>
	function isPhoneNo(phone) { 
	 var pattern = /^1[34578]\d{9}$/; 
	 return pattern.test(phone); 
	};
  function add_info(){
	  $('#err_phone').hide();	
	  var form_phone = $('#form_phone').val();
	  var phone = isPhoneNo(form_phone);
	  if(phone){
	  	var name = $('#name').html('<label id="phone"></label>');
	  	var address = $('#address').html('');

		  var name = $('#name').prepend($('#form_name').val());
		  var phone = $('#phone').append(phone);
		  var address = $('#address').append($('#form_address').val());
			$('#close').click();
	  }else{
	  	$('#err_phone').show();
	  	return false;
	  }
  };
  
	wx.config({
		debug: true,
		appId: '<%= config.appid %>',
		timeStamp: '<%= config.timestamp %>',
		nonceStr: '<%= config.nonceStr %>',
		signature: '<%= config.signature %>',
		jsApiList: ['chooseWXPay']

	});
	wx.ready(function() {
		document.querySelector('#chooseWXPay').onclick = function() {
			wx.chooseWXPay({
				timestamp: '<%= data.timeStamp %>',
				nonceStr: '<%= data.nonceStr %>',
				package: '<%= data.package %>',
				signType: '<%= data.signType %>',
				paySign: '<%= data.paySign %>',
				success: function(res) {
					alert('支付成功');
				},
				fail: function(res) {
					alert('支付失败');
				}
			});
		};
	});	
</script>
<body>
   <div class="main">
	<div class="order">

<!-- 按钮触发模态框 -->
<button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
    新建收获地址
</button>

<!-- 模态框（Modal） -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    设置收获地址
                </h4>
            </div>
            <form id="form_data">
            <div class="modal-body">
                名字: <input type="text" id="form_name" name="name"><br>
                电话: <input type="text" id="form_phone" name="phone">
                <label id="err_phone" style="color: red;">请输入正确手机号码</label><br>
                <script>$('#err_phone').hide();</script>
                地址: <input type="text" id="form_address" name="address"><br>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" id="close">关闭
                </button>
                <button type="button" onclick="add_info()" class="btn btn-primary">
                    提交更改
                </button>
            </div>
            </form>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>

			<div class="order-address">
				<p class="userinfo" id="name"><label id="phone"></label></p>
				<span class="useraddress" id="address"></span>
			</div>

			<div class="order-item">
				<div class="order-top">订单信息</div>
				<div class="order-center">
					<a href="javascript:" class="order-shoplist">
						<img src="/images/26659155088350080_03.jpg" alt="" />
						<div class="order-shoplist_right">
							<div class="shoplist_title">
								<span>繁华混合鲜花月套餐</span>
								<label>￥169.00</label>
							</div>
							<span class="shoplist_ms">
								<i>订几个月：1个月</i>
								<i>送达日期：周六送达</i>
							</span>
						</div>
					</a>
					<div class="order-number">
						<span>订单号：</span>
						<label>W121231564541321</label>
					</div>
				</div>
			</div>
			<div class="order-item">
				<div class="order-top">订单费用</div>
				<div class="order-center">
					<ul>
						<li>
							<span>商品总额：</span>
							<label>￥169.00</label>
						</li>
						<li>
							<span>运费：</span>
							<label>￥0.00</label>
						</li>
						<li>
							<span>付款金额：</span>
							<label style="color: #ff4141;">￥169.00</label>
						</li>
					</ul>
				</div>
			</div>
			<div class="sum-btn">
				<div class="btnlist">
					<a href="javascript:" id="chooseWXPay">购买</a>
				</div>
			</div>
		</div>
	</div>
</body>
</html>
