<!DOCTYPE html>
<html>
<head>
	<title>测试支付</title>
	<meta charset="utf-8">
</head>
<body>
<div>
	<ul>
		<li>基础接口</li>
	</ul>
</div>
<div>
	<h1>判断当前用户客户端是否支持js接口</h1>
	<button id="checkjsAPI">checkjsAPI</button>

	<h1>立即支付0.1元</h1>
	<button id="chooseWXPay">chooseWXPay</button>
</div>
<script src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<!-- <script>
	function jsApiCall() {
		WeixinJSBridge.invoke(
			'getBrandWCPayRequest',{
				"appId": "<%= config.appid %>",
				"timeStamp": "<%= config.timestamp %>",
				"nonceStr": "<%= config.nonceStr %>",
				"package": "<%= data.package %>",
				"signType": "<%= data.signType %>",
				"paySign": "<%= data.paySign %>"
			},function(res) {
				WeixinJSBridge.log(res.err_msg);
				alert(res.err_code);
			});
	}

	function callpay() {
		if(typeof WeixinJSBridge == 'undefined'){
			if(document.addEventListener){
				document.addEventListener('WeixinJSBridge', jsApiCall, false);
			}else if(document.attachEvent) {
				document.attachEvent('WeixinJSBridge', jsApiCall);
				document.attachEvent('onWeixinJSBridgeReady', jsApiCall);
			}else{
				jsApiCall();
			}
		}
	}
</script> -->
<script>
alert(location.href.split('#')[0]);
	wx.config({
		debug: true,
		appId: '<%= config.appid %>',
		timeStamp: '<%= config.timestamp %>',
		nonceStr: '<%= config.nonceStr %>',
		signature: '<%= config.signature %>',
		jsApiList: ['chooseWXPay']

	});
	wx.ready(function() {
		document.querySelector('#checkjsAPI').onclick = function() {
			wx.checkJsApi({
				jsApiList: ['chooseWXPay'],
				success: function(res) {
					console.log(typeof res);
					console.log(res);
					console.log(res.checkResult);
				}
			});
		};

		document.querySelector('#chooseWXPay').onclick = function() {
			alert('<%= data.timeStamp %>');
			alert('<%= data.nonceStr %>');
			alert('<%= data.package %>');
			alert('<%= data.signType %>');
			alert('<%= data.paySign %>');
			wx.chooseWXPay({
				timeStamp: '<%= data.timeStamp %>',
				nonceStr: '<%= data.nonceStr %>',
				package: '<%= data.package %>',
				signType: '<%= data.signType %>',
				paySign: '<%= data.paySign %>',
				success: function(res) {
					alert('1');
					alert(res.toString());
				},
				fail: function(res) {
					alert('2');
					alert(res.errMsg);
				},
				cancel: function(res) {
					alert('3');					
					alert(res.toString());
				}
			});
		};
	});
</script>
</body>
</html>